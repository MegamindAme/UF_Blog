
		
		function bindPostButtons(el) {
			el.find('.js-edit-post').click(function() {
				$("body").ufModal({
					sourceUrl: site.uri.public + "/modals/blog/post/edit",
					ajaxParams: {
						slug: page.blog.slug,
						id: $(this).data('postId')
					},
					msgTarget: $("#alerts-page")
				});
				$('body').on('renderSuccess.ufModal', function (data) {	
					$("#edit-post").ufForm({
						validators: page.validators.postEdit,
						msgTarget: $("#blog-alert")
					}).on("submitSuccess.ufForm", function(event, data, textStatus, jqXHR) {
						window.location.reload();
					});
				});	
			});
			el.find('.js-delete-post').click(function() {
				$("body").ufModal({
					sourceUrl: site.uri.public + "/modals/blog/post/delete",
					ajaxParams: {
						slug: page.blog.slug,
						id: $(this).data('postId')
					},
					msgTarget: $("#alerts-page")
				});
				$('body').on('renderSuccess.ufModal', function (data) {	
					$("#post-delete").ufForm({
						msgTarget: $("#blog-alert")
					}).on("submitSuccess.ufForm", function(event, data, textStatus, jqXHR) {
						window.location.reload();
					});
				});	
			});	
		}
		
		$(document).ready(function() {		
			$("#postsTable").ufTable({
				dataUrl: site.uri.public + "/api/blogs/b/" + page.blog.slug + "/posts"
			});
			
			$("#postsTable").on("pagerComplete.ufTable", function () {
			    bindPostButtons($(this));
			});
			
			$("#btn_create_post").click(function() {
				$('body').ufModal({
					// URL that serves the modal HTML
					sourceUrl: site.uri.public + '/modals/blog/post/create',
					ajaxParams : {
						"blog_slug" : page.blog.slug
					},
					// Target element to display any errors generated by the modal request
					msgTarget: $('#alerts-page')
				});

				
				
				
				
				$('body').on('renderSuccess.ufModal', function (data) {
					tinymce.init({
						selector: ".js-editor",
						plugins: "a11ychecker, advcode, formatpainter, linkchecker, media mediaembed, powerpaste, tinydrive, tinymcespellchecker",
						toolbar: "a11ycheck, code, formatpainter, insertfile"
						});
											
					$("#create-post").ufForm({
						validators: page.validators.postCreate,
						msgTarget: $("#blog-alert")
					}).on("submitSuccess.ufForm", function(event, data, textStatus, jqXHR) {
						window.location.reload();
					});
				});
			});
		});